@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========================================
   VARIABLES CSS PERSONNALISÉES
======================================== */
:root {
  /* Couleurs */
  --color-primary: 24 24 27; /* zinc-900 */
  --color-primary-foreground: 250 250 250; /* zinc-50 */
  --color-secondary: 244 244 245; /* zinc-100 */
  --color-secondary-foreground: 24 24 27; /* zinc-900 */
  --color-muted: 244 244 245; /* zinc-100 */
  --color-muted-foreground: 113 113 122; /* zinc-500 */
  --color-accent: 244 244 245; /* zinc-100 */
  --color-accent-foreground: 24 24 27; /* zinc-900 */
  --color-destructive: 239 68 68; /* red-500 */
  --color-destructive-foreground: 254 242 242; /* red-50 */
  --color-border: 228 228 231; /* zinc-200 */
  --color-input: 228 228 231; /* zinc-200 */
  --color-ring: 24 24 27; /* zinc-900 */
  --color-background: 250 250 250; /* zinc-50 */
  --color-foreground: 24 24 27; /* zinc-900 */
  --color-card: 255 255 255; /* white */
  --color-card-foreground: 24 24 27; /* zinc-900 */
  --color-popover: 255 255 255; /* white */
  --color-popover-foreground: 24 24 27; /* zinc-900 */

  /* Espacements */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;

  /* Rayons de bordure */
  --radius-sm: 0.375rem;
  --radius-md: 0.75rem;
  --radius-lg: 1rem;
  --radius-xl: 1.5rem;

  /* Ombres */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  /* Animations */
  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* Mode sombre (optionnel pour plus tard) */
@media (prefers-color-scheme: dark) {
  :root {
    --color-background: 9 9 11; /* zinc-900 */
    --color-foreground: 250 250 250; /* zinc-50 */
    --color-card: 24 24 27; /* zinc-800 */
    --color-card-foreground: 250 250 250; /* zinc-50 */
    --color-popover: 24 24 27; /* zinc-800 */
    --color-popover-foreground: 250 250 250; /* zinc-50 */
    --color-primary: 250 250 250; /* zinc-50 */
    --color-primary-foreground: 24 24 27; /* zinc-900 */
    --color-secondary: 39 39 42; /* zinc-700 */
    --color-secondary-foreground: 250 250 250; /* zinc-50 */
    --color-muted: 39 39 42; /* zinc-700 */
    --color-muted-foreground: 161 161 170; /* zinc-400 */
    --color-accent: 39 39 42; /* zinc-700 */
    --color-accent-foreground: 250 250 250; /* zinc-50 */
    --color-destructive: 127 29 29; /* red-800 */
    --color-destructive-foreground: 254 242 242; /* red-50 */
    --color-border: 39 39 42; /* zinc-700 */
    --color-input: 39 39 42; /* zinc-700 */
    --color-ring: 212 212 216; /* zinc-300 */
  }
}

/* ========================================
   BASE STYLES
======================================== */
@layer base {
  * {
    @apply border-border;
  }
  
  html {
    scroll-behavior: smooth;
  }
  
  body {
    @apply bg-background text-foreground antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
  
  /* Améliorer l'accessibilité */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
  
  /* Focus visible pour l'accessibilité */
  *:focus-visible {
    @apply ring-2 ring-ring ring-offset-2 outline-none;
  }
  
  /* Scrollbar personnalisée */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-secondary;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-primary;
  }
}

/* ========================================
   COMPONENTS STYLES
======================================== */
@layer components {
  /* Container principal */
  .container {
    @apply max-w-6xl mx-auto px-4 sm:px-6 lg:px-8;
  }
  
  /* Card de base */
  .card {
    @apply bg-card rounded-2xl shadow-sm border border-border text-card-foreground;
    box-shadow: var(--shadow-sm);
    transition: box-shadow var(--transition-fast);
  }
  
  .card:hover {
    box-shadow: var(--shadow-md);
  }
  
  /* Typographie */
  .h1 {
    @apply text-3xl font-bold tracking-tight sm:text-4xl;
  }
  
  .h2 {
    @apply text-2xl font-semibold tracking-tight;
  }
  
  .h3 {
    @apply text-xl font-semibold tracking-tight;
  }
  
  .h4 {
    @apply text-lg font-semibold;
  }
  
  .lead {
    @apply text-xl text-muted-foreground;
  }
  
  .large {
    @apply text-lg font-semibold;
  }
  
  .subtle {
    @apply text-sm text-muted-foreground;
  }
  
  .muted {
    @apply text-sm text-muted-foreground;
  }
  
  .small {
    @apply text-sm font-medium leading-none;
  }
  
  /* Boutons de base */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-medium transition-all;
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2;
    @apply disabled:pointer-events-none disabled:opacity-50;
    transition: all var(--transition-fast);
  }
  
  .btn-primary {
    @apply bg-primary text-primary-foreground shadow;
    @apply hover:bg-primary/90;
  }
  
  .btn-secondary {
    @apply bg-secondary text-secondary-foreground shadow-sm;
    @apply hover:bg-secondary/80;
  }
  
  .btn-destructive {
    @apply bg-destructive text-destructive-foreground shadow-sm;
    @apply hover:bg-destructive/90;
  }
  
  .btn-outline {
    @apply border border-input bg-background shadow-sm;
    @apply hover:bg-accent hover:text-accent-foreground;
  }
  
  .btn-ghost {
    @apply hover:bg-accent hover:text-accent-foreground;
  }
  
  .btn-link {
    @apply text-primary underline-offset-4 hover:underline;
  }
  
  /* Metrics */
  .metric {
    @apply p-4 rounded-xl bg-muted/50 border border-border;
    transition: all var(--transition-fast);
  }
  
  .metric:hover {
    @apply bg-muted;
  }
  
  /* États d'erreur */
  .error {
    @apply text-destructive;
  }
  
  .error-bg {
    @apply bg-destructive/10 text-destructive;
  }
  
  /* États de succès */
  .success {
    @apply text-green-600;
  }
  
  .success-bg {
    @apply bg-green-50 text-green-800 border-green-200;
  }
  
  /* États d'avertissement */
  .warning {
    @apply text-yellow-600;
  }
  
  .warning-bg {
    @apply bg-yellow-50 text-yellow-800 border-yellow-200;
  }
  
  /* États d'information */
  .info {
    @apply text-blue-600;
  }
  
  .info-bg {
    @apply bg-blue-50 text-blue-800 border-blue-200;
  }
}

/* ========================================
   UTILITIES PERSONNALISÉES
======================================== */
@layer utilities {
  /* Animations personnalisées */
  .animate-fade-in {
    animation: fadeIn var(--transition-normal) ease-out;
  }

  .animate-slide-up {
    animation: slideUp var(--transition-normal) ease-out;
  }

  .animate-pulse-subtle {
    animation: pulseSubtle 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  /* Gradient de fond */
  .bg-gradient-subtle {
    background: linear-gradient(135deg, rgb(250 250 250) 0%, rgb(244 244 245) 100%);
  }

  /* Texte avec gradient */
  .text-gradient {
    @apply bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent;
  }

  /* Bordures personnalisées */
  .border-gradient {
    border-image: linear-gradient(135deg, rgb(228 228 231), rgb(244 244 245)) 1;
  }

  /* Hide scrollbar utility */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

/* ========================================
   KEYFRAMES POUR ANIMATIONS
======================================== */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseSubtle {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.8;
  }
}

/* ========================================
   PROVISIONS ANIMATIONS
======================================== */
@layer components {
  /* Animations pour les provisions */
  .provision-card {
    @apply transition-all duration-300 ease-in-out;
    transform: translateY(0);
  }
  
  .provision-card:hover {
    @apply shadow-lg;
    transform: translateY(-2px);
  }
  
  .provision-appear {
    animation: provisionAppear 0.5s ease-out forwards;
  }
  
  .provision-disappear {
    animation: provisionDisappear 0.3s ease-in forwards;
  }
  
  /* Progress bar animation */
  .progress-bar {
    @apply transition-all duration-1000 ease-out;
  }
  
  /* Modal animations */
  .modal-overlay {
    animation: modalOverlayFadeIn 0.2s ease-out;
  }
  
  .modal-content {
    animation: modalContentSlideIn 0.3s ease-out;
  }
  
  .modal-exit {
    animation: modalContentSlideOut 0.2s ease-in forwards;
  }
  
  /* Icon hover effects */
  .icon-hover {
    @apply transition-transform duration-200 ease-in-out;
  }
  
  .icon-hover:hover {
    transform: scale(1.1);
  }
  
  /* Color picker animation */
  .color-option {
    @apply transition-all duration-200 ease-in-out;
  }
  
  .color-option:hover {
    transform: scale(1.15);
  }
  
  /* Slider custom styles */
  .provision-slider {
    @apply appearance-none h-2 rounded-lg cursor-pointer;
    transition: background 0.3s ease;
  }
  
  .provision-slider::-webkit-slider-thumb {
    @apply appearance-none w-5 h-5 rounded-full cursor-pointer;
    background: currentColor;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease;
  }
  
  .provision-slider::-webkit-slider-thumb:hover {
    transform: scale(1.1);
  }
  
  /* Toast notification animations */
  .toast-enter {
    animation: toastSlideIn 0.3s ease-out;
  }
  
  .toast-exit {
    animation: toastSlideOut 0.2s ease-in forwards;
  }
}

/* Keyframes pour les provisions */
@keyframes provisionAppear {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes provisionDisappear {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
}

@keyframes modalOverlayFadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes modalContentSlideIn {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes modalContentSlideOut {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
}

@keyframes toastSlideIn {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes toastSlideOut {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100%);
  }
}

/* ========================================
   MOBILE & TOUCH IMPROVEMENTS
======================================== */
@layer components {
  /* Minimum touch target size (44px recommended by WCAG) */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  /* Interactive elements should have adequate touch targets */
  .touch-target-inline {
    @apply min-h-[44px] flex items-center;
  }

  /* Prevent text selection on touch devices for interactive elements */
  .no-select-touch {
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Improve tap highlight on mobile */
  .tap-highlight-none {
    -webkit-tap-highlight-color: transparent;
  }

  /* Better active states for touch */
  .touch-active {
    @apply active:scale-[0.98] active:opacity-90 transition-transform duration-100;
  }

  /* Safe area padding for notched devices */
  .safe-area-top {
    padding-top: env(safe-area-inset-top, 0);
  }

  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .safe-area-left {
    padding-left: env(safe-area-inset-left, 0);
  }

  .safe-area-right {
    padding-right: env(safe-area-inset-right, 0);
  }

  .safe-area-x {
    padding-left: env(safe-area-inset-left, 0);
    padding-right: env(safe-area-inset-right, 0);
  }

  .safe-area-y {
    padding-top: env(safe-area-inset-top, 0);
    padding-bottom: env(safe-area-inset-bottom, 0);
  }

  .safe-area-all {
    padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
  }
}

/* Mobile-specific styles */
@media (max-width: 767px) {
  /* Ensure all interactive elements have adequate touch targets */
  button,
  a,
  input[type="checkbox"],
  input[type="radio"],
  select,
  .btn {
    min-height: 44px;
  }

  /* Prevent horizontal scroll on mobile */
  .container {
    overflow-x: hidden;
  }

  /* Larger fonts for mobile readability */
  html {
    font-size: 16px; /* Prevents zoom on iOS */
    -webkit-text-size-adjust: 100%;
  }

  /* Disable hover states on touch devices to prevent sticky hovers */
  @media (hover: none) {
    .hover\:bg-gray-50:hover,
    .hover\:bg-zinc-100:hover,
    .hover\:shadow-md:hover {
      background-color: inherit;
      box-shadow: inherit;
    }
  }
}

/* iOS specific fixes */
@supports (-webkit-touch-callout: none) {
  /* Fix for iOS momentum scrolling */
  .overflow-y-auto,
  .overflow-auto {
    -webkit-overflow-scrolling: touch;
  }

  /* Fix for iOS input zoom */
  input,
  select,
  textarea {
    font-size: 16px;
  }
}

/* ========================================
   PRINT STYLES
======================================== */
@media print {
  * {
    background: transparent !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  
  a, a:visited {
    text-decoration: underline;
  }
  
  .no-print {
    display: none !important;
  }
}